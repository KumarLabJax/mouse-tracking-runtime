// development configuration file

params {
    reference_cache='/media/bgeuther/Storage/TempStorage/onnx/onnx-pipelines/nextflow'
    pubdir = "/media/bgeuther/Storage/TempStorage/onnx/onnx-pipelines/nf-tests"
    tracking_code_dir = "/kumar_lab_models/mouse-tracking-runtime/"
    gait_code_dir = "/gait-analysis/"
    vfi_code_dir = "/vfi/Code/"
}

singularity {
   enabled = true
   autoMounts = true
}

process {
    executor = 'local'
    withLabel: "gpu" {
        maxForks = 1
        containerOptions = "--nv"
    }


    /*
     * Runtime options
     */
    withLabel: "tracking" {
        container = "/media/bgeuther/Storage/TempStorage/onnx/onnx-pipelines/vm/deployment-runtime_2025-02-06.sif"
    }
    withLabel: "jabs_classify_0.18.0" {
        container = "/media/bgeuther/Storage/TempStorage/JABS-GUI_dev.sif"

        // Folder containing the built classifier artifacts
        classifier_project_folders = "/media/bgeuther/Storage/TempStorage/jabs-classifiers/project_folders/"

        exported_classifier_folder = "/media/bgeuther/Storage/TempStorage/jabs-classifiers/exported_classifiers/"
        classifier_artifact_suffix = "_classifier_v0.18.0.pkl"
        // TODO Automate extracting the window sizes from the classifier files
        classifier_window_sizes = [2, 5, 10, 20, 30, 60]
        // Mapping of classifier names to exported classifier names
        single_mouse_classifiers = [
            grooming: "grooming",
            rearing_supported: "jabs-vivek",
            rearing_unsupported: "jab-vivek",
            left_turn: "jabs-vivek",
            right_turn: "jabs-vivek",
            escape: "jabs-vivek",
            scratch: "jabs-paper",
            jerk: "social-play",
            leg_splay: "ptz",
            side_seizure: "ptz",
            tail_jerk: "ptz",
            wild_jumping: "ptz",
        ]
        // Multi Mouse Classifiers
        // TODO
    }
    withLabel: "jabs_postprocess" {
        container = "/media/bgeuther/Storage/TempStorage/JABS-Postprocessing-2024-12-17_6acaeb7.sif"
        heuristic_classifiers = ["corner", "corner_facing", "freeze", "locomotion", "periphery", "wall_facing"]
    }
    withLabel: "gait" {
        container = "/media/bgeuther/Storage/TempStorage/onnx/onnx-pipelines/tests/gait/gaitanalysis/vm/gait-pipeline-2025-01-30.sif"
    }
        withLabel: "frailty" {
        container = "/media/bgeuther/Storage/TempStorage/onnx/onnx-pipelines/tests/vfi/vFI-features/vm/vfi-2025-02-04.sif"
    }
    withLabel: "dropbox" {
        DROPBOX_PREFIX = "labdropbox:KumarLab's shared workspace/VideoData/MDS_Tests"
    }
}

executor {
    name = 'local'
}
